# 사용자 관리

TagFlow 시스템의 사용자 계정을 생성하고 관리하는 방법을 안내합니다.

```
⚠️ 관리자 전용 기능
이 기능은 관리자(Admin) 역할만 사용할 수 있습니다.
```

## 사용자 관리 개요

TagFlow는 역할 기반 접근 제어(RBAC)를 사용합니다. 두 가지 역할이 있습니다:

- **Admin (관리자)**: 모든 시스템 기능에 접근 가능
- **Operator (운영자)**: 제한된 읽기 전용 기능만 접근 가능

## 사용자 목록 조회

### 사용자 관리 페이지 접근

1. 관리자 계정으로 로그인
2. 사이드바에서 **관리 > 사용자 관리** 클릭
3. 현재 등록된 모든 사용자 목록이 표시됩니다

### 사용자 목록 정보

사용자 목록에는 다음 정보가 표시됩니다:

| 컬럼         | 설명                       |
| ------------ | -------------------------- |
| **ID**       | 사용자 고유 번호           |
| **사용자명** | 로그인에 사용되는 사용자명 |
| **이름**     | 사용자의 실제 이름         |
| **역할**     | Admin 또는 Operator        |
| **생성일**   | 계정 생성 날짜             |
| **작업**     | 편집/삭제 버튼             |

### 필터링 및 검색

- **검색**: 사용자명 또는 이름으로 검색
- **역할 필터**: 특정 역할의 사용자만 표시
- **정렬**: 컬럼 헤더 클릭으로 정렬

## 새 사용자 생성

### 단계별 가이드

#### 1. 사용자 생성 버튼 클릭

사용자 관리 페이지 상단의 **"+ 새 사용자"** 버튼을 클릭합니다.

#### 2. 사용자 정보 입력

사용자 생성 폼에서 다음 정보를 입력합니다:

```
필수 입력 항목:
- 사용자명 (username)
- 비밀번호 (password)
- 비밀번호 확인 (confirm password)
- 이름 (name)
- 역할 (role)
```

**사용자명 규칙**:

- 3~20자 사이
- 영문 소문자, 숫자, 언더스코어(\_) 사용 가능
- 영문자로 시작해야 함
- 공백 및 특수문자 불가
- 중복 불가

**비밀번호 규칙**:

- 최소 8자 이상
- 영문, 숫자 조합 권장
- 특수문자 포함 권장

**이름**:

- 실제 사용자 이름
- 한글, 영문 모두 가능
- 2~50자 사이

**역할**:

- **Admin**: 관리자 - 모든 기능 접근
- **Operator**: 운영자 - 제한된 기능만 접근

#### 3. 저장

모든 정보를 입력한 후 **"생성"** 버튼을 클릭합니다.

### 생성 예시

#### 관리자 계정 생성 예시

```
사용자명: hong_admin
비밀번호: SecurePass123!
비밀번호 확인: SecurePass123!
이름: 홍길동
역할: Admin
```

#### 운영자 계정 생성 예시

```
사용자명: kim_operator
비밀번호: SafePass456!
비밀번호 확인: SafePass456!
이름: 김철수
역할: Operator
```

## 사용자 정보 수정

### 사용자 편집

#### 1. 편집 버튼 클릭

사용자 목록에서 수정하려는 사용자의 **편집** 버튼을 클릭합니다.

#### 2. 정보 수정

다음 정보를 수정할 수 있습니다:

- **이름**: 사용자의 실제 이름
- **역할**: Admin ↔ Operator 변경
- **비밀번호**: 새 비밀번호 설정 (선택사항)

```
⚠️ 주의
사용자명(username)은 생성 후 변경할 수 없습니다.
```

#### 3. 저장

변경사항을 **"저장"** 버튼으로 확인합니다.

### 비밀번호 변경

#### 본인 비밀번호 변경

모든 사용자는 자신의 비밀번호를 변경할 수 있습니다:

1. 우측 상단 사용자 메뉴 클릭
2. **"비밀번호 변경"** 선택
3. 현재 비밀번호 입력
4. 새 비밀번호 입력 및 확인
5. **"변경"** 버튼 클릭

#### 관리자가 다른 사용자 비밀번호 변경

관리자는 모든 사용자의 비밀번호를 재설정할 수 있습니다:

1. 사용자 목록에서 해당 사용자 **편집** 클릭
2. **"비밀번호 재설정"** 체크박스 선택
3. 새 비밀번호 입력 및 확인
4. **"저장"** 버튼 클릭

```
💡 팁
비밀번호를 잊어버린 사용자를 위해 관리자가 임시 비밀번호를 설정하고,
해당 사용자에게 첫 로그인 후 변경하도록 안내하세요.
```

## 역할 변경

### Admin → Operator

관리자를 운영자로 변경하는 경우:

1. 사용자 편집 페이지에서 역할을 "Operator"로 선택
2. **"저장"** 클릭
3. 해당 사용자는 다음 로그인부터 운영자 권한만 가집니다

```
⚠️ 영향
- 관리 메뉴 접근 불가
- 웹훅 생성/편집 불가
- 사용자 관리 불가
- 데이터 정리 로그 접근 불가
```

### Operator → Admin

운영자를 관리자로 승격하는 경우:

1. 사용자 편집 페이지에서 역할을 "Admin"으로 선택
2. **"저장"** 클릭
3. 해당 사용자는 다음 로그인부터 모든 관리 기능에 접근 가능

```
💡 보안 권장사항
관리자 역할은 신중하게 부여하세요. 필요한 최소한의 인원만 관리자로 유지하는 것이 좋습니다.
```

## 사용자 삭제

### 삭제 절차

#### 1. 삭제 버튼 클릭

사용자 목록에서 삭제하려는 사용자의 **삭제** 버튼을 클릭합니다.

#### 2. 확인 대화상자

삭제 확인 대화상자가 나타납니다:

```
정말로 사용자 'username'을(를) 삭제하시겠습니까?
이 작업은 취소할 수 없습니다.
```

#### 3. 삭제 확인

**"삭제"** 버튼을 클릭하여 최종 확인합니다.

### 삭제 시 주의사항

```
⚠️ 중요
- 삭제된 사용자는 복구할 수 없습니다
- 해당 사용자가 남긴 이벤트 기록은 삭제되지 않습니다
- 기본 admin 계정은 삭제할 수 없습니다
```

### 삭제할 수 없는 경우

다음 경우 사용자를 삭제할 수 없습니다:

- **기본 admin 계정**: 시스템에 최소 1명의 관리자가 필요
- **현재 로그인 중인 계정**: 본인 계정은 삭제 불가
- **시스템 계정**: 내부 시스템 계정(있는 경우)

## 역할별 권한 비교

### Admin (관리자)

| 기능                | 접근 권한 |
| ------------------- | --------- |
| 태그 이벤트 조회    | ✅ 가능   |
| 리포트 조회         | ✅ 가능   |
| 웹훅 로그 조회      | ✅ 가능   |
| 사용자 관리         | ✅ 가능   |
| 웹훅 생성/편집/삭제 | ✅ 가능   |
| 웹훅 테스트         | ✅ 가능   |
| 정리 로그 조회      | ✅ 가능   |
| 수동 데이터 정리    | ✅ 가능   |
| 시스템 설정         | ✅ 가능   |

### Operator (운영자)

| 기능                | 접근 권한    |
| ------------------- | ------------ |
| 태그 이벤트 조회    | ✅ 가능      |
| 리포트 조회         | ✅ 가능      |
| 웹훅 로그 조회      | ✅ 읽기 전용 |
| 사용자 관리         | ❌ 불가      |
| 웹훅 생성/편집/삭제 | ❌ 불가      |
| 웹훅 테스트         | ❌ 불가      |
| 정리 로그 조회      | ❌ 불가      |
| 수동 데이터 정리    | ❌ 불가      |
| 시스템 설정         | ❌ 불가      |

## 사용자 관리 모범 사례

### 계정 생성 원칙

1. **최소 권한 원칙 (Principle of Least Privilege)**

   - 필요한 최소한의 권한만 부여
   - 대부분의 사용자는 Operator로 충분

2. **명확한 사용자명 규칙**

   - 조직의 사용자명 규칙 정의
   - 예: `이름_역할` (hong_admin, kim_operator)

3. **강력한 비밀번호 정책**
   - 최소 12자 이상 권장
   - 영문 대소문자, 숫자, 특수문자 조합
   - 주기적인 변경 (3~6개월)

### 계정 관리 프로세스

1. **신규 사용자 온보딩**

   ```
   1. 사용자 계정 생성 (운영자 역할)
   2. 임시 비밀번호 전달 (안전한 채널 사용)
   3. 첫 로그인 후 비밀번호 변경 안내
   4. 시스템 사용 교육
   ```

2. **퇴사자 처리**

   ```
   1. 퇴사 당일 즉시 계정 비활성화 또는 삭제
   2. 보안 로그 확인
   3. 필요시 관련 데이터 백업
   ```

3. **정기 감사**
   ```
   1. 월 1회 사용자 목록 검토
   2. 비활성 계정 확인 및 삭제
   3. 역할 할당 적정성 검토
   4. 비밀번호 변경 이력 확인
   ```

### 보안 권장사항

#### 비밀번호 보안

- **절대 금지**:

  - 기본 비밀번호 그대로 사용
  - 여러 계정에 동일한 비밀번호 사용
  - 사용자명과 유사한 비밀번호
  - 간단한 패턴 (123456, password 등)

- **적극 권장**:
  - 비밀번호 관리자 사용
  - 정기적인 비밀번호 변경
  - 복잡한 문자 조합

#### 역할 관리

- **관리자 역할**:

  - 조직에서 최소 2명 이상 유지 (백업)
  - 최대 5명 이하로 제한 권장
  - 정기적인 권한 검토

- **운영자 역할**:
  - 대부분의 일상 작업에 충분
  - 감사 추적(audit trail) 용이

## API를 통한 사용자 관리

개발자는 REST API로도 사용자를 관리할 수 있습니다.

### 사용자 목록 조회

```bash
GET /auth/users
Authorization: Bearer {access_token}
```

### 사용자 생성

```bash
POST /auth/users
Authorization: Bearer {access_token}
Content-Type: application/json

{
  "username": "new_user",
  "password": "SecurePass123!",
  "name": "신규 사용자",
  "role": "operator"
}
```

### 사용자 수정

```bash
PUT /auth/users/:id
Authorization: Bearer {access_token}
Content-Type: application/json

{
  "name": "수정된 이름",
  "role": "admin"
}
```

### 사용자 삭제

```bash
DELETE /auth/users/:id
Authorization: Bearer {access_token}
```

자세한 API 사용법은 [API 레퍼런스](../../developer-guides/api-reference.md)를 참조하세요.

## 문제 해결

### 사용자를 생성할 수 없어요

**증상**: 사용자 생성 시 오류가 발생합니다.

**가능한 원인 및 해결책**:

1. **중복된 사용자명**

   - 이미 존재하는 사용자명입니다
   - 다른 사용자명을 사용하세요

2. **유효하지 않은 사용자명**

   - 사용자명 규칙을 확인하세요
   - 3~20자, 영문 소문자/숫자/언더스코어만 사용

3. **약한 비밀번호**
   - 최소 8자 이상 사용
   - 영문, 숫자 조합

### 사용자가 로그인할 수 없어요

**증상**: 생성한 사용자가 로그인하지 못합니다.

**해결책**:

1. 사용자명과 비밀번호가 정확한지 확인
2. 대소문자 구분 확인
3. 계정이 활성화되어 있는지 확인
4. 데이터베이스 연결 상태 확인

### 역할 변경이 즉시 적용되지 않아요

**증상**: 역할을 변경했는데 권한이 바뀌지 않습니다.

**해결책**:

1. 해당 사용자가 로그아웃 후 재로그인하도록 안내
2. 브라우저 캐시 삭제
3. 세션 토큰 재발급

## 관련 문서

- [시작하기](getting-started.md) - 관리자 첫 로그인
- [시스템 설정](system-settings.md) - 시스템 보안 설정
- [인증 시스템](../../feature-guides/authentication.md) - 인증 구조 이해
- [API 레퍼런스](../../developer-guides/api-reference.md) - API 사용법
