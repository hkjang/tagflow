(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5020:function(e,t,r){Promise.resolve().then(r.bind(r,1911))},1911:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var o=r(7821),n=r(8397),a=r.n(n),s=r(6179),i=r(1981);function l(){let e=(0,s.useRouter)(),{user:t,isAuthenticated:r,logout:n,isLoading:l}=(0,i.a)();return r&&t?(e.push("/dashboard"),null):l?(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},className:"jsx-7a90291f0de70b21",children:[(0,o.jsx)("div",{style:{width:"50px",height:"50px",border:"4px solid #e5e7eb",borderTop:"4px solid #2563eb",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-7a90291f0de70b21"}),(0,o.jsx)(a(),{id:"7a90291f0de70b21",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",fontFamily:"system-ui, -apple-system, sans-serif",backgroundColor:"#f3f4f6",padding:"1rem"},children:(0,o.jsxs)("div",{style:{width:"100%",maxWidth:"600px",textAlign:"center"},children:[(0,o.jsx)("h1",{style:{fontSize:"3rem",fontWeight:"bold",color:"#1f2937",marginBottom:"1rem"},children:"TagFlow"}),(0,o.jsx)("p",{style:{fontSize:"1.25rem",color:"#6b7280",marginBottom:"2rem"},children:"RFID Tag Management System"}),!r&&(0,o.jsxs)("div",{style:{padding:"2rem",backgroundColor:"white",borderRadius:"0.75rem",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",marginBottom:"1rem"},children:[(0,o.jsx)("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"Please sign in to access the system"}),(0,o.jsx)("button",{onClick:()=>e.push("/login"),style:{padding:"0.625rem 1.5rem",fontSize:"0.875rem",fontWeight:"500",color:"white",backgroundColor:"#2563eb",border:"none",borderRadius:"0.375rem",cursor:"pointer",transition:"background-color 0.15s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#1d4ed8",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#2563eb",children:"Sign in"})]}),(0,o.jsx)("div",{style:{padding:"1.5rem",backgroundColor:"white",borderRadius:"0.75rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,o.jsxs)("p",{style:{color:"#374151",fontSize:"0.875rem"},children:["Backend API:"," ",(0,o.jsx)("a",{href:"http://localhost:3001",target:"_blank",rel:"noopener noreferrer",style:{color:"#2563eb",textDecoration:"none"},onMouseEnter:e=>e.currentTarget.style.textDecoration="underline",onMouseLeave:e=>e.currentTarget.style.textDecoration="none",children:"http://localhost:3001"})]})})]})})}},1981:function(e,t,r){"use strict";r.d(t,{a:function(){return s}});var o=r(8433),n=r(2076);let a={login:async e=>(await n.Z.post("/auth/login",e)).data,refreshToken:async e=>(await n.Z.post("/auth/refresh",{refresh_token:e})).data,getCurrentUser:async()=>(await n.Z.get("/auth/me")).data,logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}},s=(0,o.Ue)((e,t)=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isLoading:!0,setTokens:(t,r)=>{localStorage.setItem("access_token",t),localStorage.setItem("refresh_token",r),e({accessToken:t,refreshToken:r,isAuthenticated:!0})},setUser:t=>{e({user:t,isAuthenticated:!!t})},setLoading:t=>{e({isLoading:t})},login:async(r,o)=>{try{e({isLoading:!0});let n=await a.login({username:r,password:o});t().setTokens(n.access_token,n.refresh_token),e({user:n.user,isAuthenticated:!0})}catch(e){throw console.error("Login failed:",e),e}finally{e({isLoading:!1})}},logout:()=>{a.logout(),e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1})},refreshUser:async()=>{try{e({isLoading:!0});let t=await a.getCurrentUser();e({user:t,isAuthenticated:!0})}catch(e){console.error("Failed to refresh user:",e),t().logout()}finally{e({isLoading:!1})}}}));{let e=localStorage.getItem("access_token"),t=localStorage.getItem("refresh_token");e&&t?(s.setState({accessToken:e,refreshToken:t,isAuthenticated:!0,isLoading:!0}),s.getState().refreshUser()):s.setState({isLoading:!1})}},2076:function(e,t,r){"use strict";var o=r(1892);let n=r(9792).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",a=o.Z.create({baseURL:n,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var t,r,s;let i=e.config,l=(null===(t=i.url)||void 0===t?void 0:t.includes("/auth/login"))||(null===(r=i.url)||void 0===r?void 0:r.includes("/auth/refresh")),c=localStorage.getItem("refresh_token");if((null===(s=e.response)||void 0===s?void 0:s.status)===401&&!i._retry&&!l&&c){i._retry=!0;try{let{access_token:e,refresh_token:t}=(await o.Z.post("".concat(n,"/auth/refresh"),{refresh_token:c})).data;return localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",t),i.headers&&(i.headers.Authorization="Bearer ".concat(e)),a(i)}catch(e){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)}),t.Z=a}},function(e){e.O(0,[885,113,115,141,744],function(){return e(e.s=5020)}),_N_E=e.O()}]);