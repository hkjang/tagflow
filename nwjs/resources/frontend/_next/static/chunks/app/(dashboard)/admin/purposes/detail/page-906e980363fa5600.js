(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[186],{9313:function(e,t,r){Promise.resolve().then(r.bind(r,772))},772:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var o=r(7821),i=r(8078),l=r(6179),a=r(4734),n=r(5463);let d=[{value:"string",label:"문자열"},{value:"number",label:"숫자"},{value:"date",label:"날짜"},{value:"select",label:"선택"}],s=[{value:"TIME_WINDOW",label:"시간대 규칙"},{value:"USER_GROUP",label:"사용자 그룹"},{value:"DUPLICATE_POLICY",label:"중복 정책"}],c=[{value:"NOTIFICATION",label:"알림"},{value:"APPROVAL",label:"승인 요청"},{value:"API_CALL",label:"외부 API 호출"}];function p(){let e=(0,l.useRouter)(),t=Number((0,l.useSearchParams)().get("id")),[r,p]=(0,i.useState)(null),[u,h]=(0,i.useState)([]),[m,g]=(0,i.useState)([]),[b,y]=(0,i.useState)([]),[f,x]=(0,i.useState)([]),[j,v]=(0,i.useState)(null),[w,k]=(0,i.useState)([]),[_,C]=(0,i.useState)(!0),[S,I]=(0,i.useState)("fields"),[R,A]=(0,i.useState)(!1),[W,B]=(0,i.useState)(!1),[z,Z]=(0,i.useState)(!1),[F,P]=(0,i.useState)(!1),[N,O]=(0,i.useState)({field_name:"",field_label:"",field_type:"string",is_required:!1,default_value:"",options:""}),[D,T]=(0,i.useState)(null),[L,Q]=(0,i.useState)({webhook_id:0,field_mappings:"{}"}),[E,q]=(0,i.useState)({rule_type:"DUPLICATE_POLICY",rule_config:'{"window_minutes": 5, "allow_duplicate": false}'}),[U,J]=(0,i.useState)({action_type:"NOTIFICATION",action_config:'{"message_template": "태그가 등록되었습니다."}'});(0,i.useEffect)(()=>{t&&H()},[t]);let H=async()=>{try{C(!0);let[e,r,o,i,l,d,s]=await Promise.all([a.Q.getPurposeById(t),a.Q.getFields(t),a.Q.getWebhooks(t),a.Q.getRules(t),a.Q.getFollowups(t),a.Q.getPurposeStats(t),n.L.getAllWebhooks()]);p(e),h(r),g(o),y(i),x(l),v(d),k(s)}catch(e){console.error("Failed to fetch data:",e)}finally{C(!1)}},M=e=>{if(e){var t;T(e),O({field_name:e.field_name,field_label:e.field_label,field_type:e.field_type,is_required:e.is_required,default_value:e.default_value||"",options:(null===(t=e.options)||void 0===t?void 0:t.join(", "))||""})}else T(null),O({field_name:"",field_label:"",field_type:"string",is_required:!1,default_value:"",options:""});A(!0)},Y=()=>{A(!1),T(null),O({field_name:"",field_label:"",field_type:"string",is_required:!1,default_value:"",options:""})},X=async()=>{try{await a.Q.createField(t,{...N,options:N.options?N.options.split(",").map(e=>e.trim()):void 0}),Y(),H()}catch(e){console.error("Failed to create field:",e)}},G=async()=>{if(D)try{await a.Q.updateField(D.id,{...N,options:N.options?N.options.split(",").map(e=>e.trim()):void 0}),Y(),H()}catch(e){console.error("Failed to update field:",e)}},V=async()=>{D?await G():await X()},K=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{await a.Q.deleteField(e),H()}catch(e){console.error("Failed to delete field:",e)}},$=async()=>{try{await a.Q.createWebhook(t,{webhook_id:L.webhook_id,field_mappings:JSON.parse(L.field_mappings)}),B(!1),Q({webhook_id:0,field_mappings:"{}"}),H()}catch(e){console.error("Failed to create webhook:",e)}},ee=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{await a.Q.deleteWebhook(e),H()}catch(e){console.error("Failed to delete webhook:",e)}},et=async()=>{try{await a.Q.createRule(t,{rule_type:E.rule_type,rule_config:JSON.parse(E.rule_config)}),Z(!1),q({rule_type:"DUPLICATE_POLICY",rule_config:'{"window_minutes": 5, "allow_duplicate": false}'}),H()}catch(e){console.error("Failed to create rule:",e)}},er=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{await a.Q.deleteRule(e),H()}catch(e){console.error("Failed to delete rule:",e)}},eo=async()=>{try{await a.Q.createFollowup(t,{action_type:U.action_type,action_config:JSON.parse(U.action_config)}),P(!1),J({action_type:"NOTIFICATION",action_config:'{"message_template": "태그가 등록되었습니다."}'}),H()}catch(e){console.error("Failed to create followup:",e)}},ei=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{await a.Q.deleteFollowup(e),H()}catch(e){console.error("Failed to delete followup:",e)}},el=e=>{let t=w.find(t=>t.id===e);return(null==t?void 0:t.name)||"Webhook #".concat(e)};return t?_||!r?(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,o.jsx)("div",{children:"로딩 중..."})}):(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:()=>e.push("/admin/purposes"),style:{color:"#3b82f6",background:"none",border:"none",cursor:"pointer",marginBottom:"0.5rem"},children:"← 목록으로"}),(0,o.jsx)("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1f2937"},children:r.name}),(0,o.jsx)("p",{style:{color:"#6b7280"},children:r.description})]}),j&&(0,o.jsxs)("div",{style:{display:"flex",gap:"1.5rem",backgroundColor:"#f3f4f6",padding:"1rem",borderRadius:"0.5rem"},children:[(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937"},children:j.events_today}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"오늘"})]}),(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937"},children:j.events_this_week}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"이번 주"})]}),(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937"},children:j.total_events}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:"전체"})]})]})]}),(0,o.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",borderBottom:"2px solid #e5e7eb"},children:[{key:"fields",label:"필드 설정",count:u.length},{key:"webhooks",label:"웹훅 연결",count:m.length},{key:"rules",label:"규칙 설정",count:b.length},{key:"followups",label:"후속 처리",count:f.length}].map(e=>(0,o.jsxs)("button",{onClick:()=>I(e.key),style:{padding:"0.75rem 1rem",backgroundColor:S===e.key?"#3b82f6":"transparent",color:S===e.key?"white":"#6b7280",border:"none",borderRadius:"0.375rem 0.375rem 0 0",cursor:"pointer",fontWeight:"500"},children:[e.label," (",e.count,")"]},e.key))}),"fields"===S&&(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600"},children:"목적별 필드"}),(0,o.jsx)("button",{onClick:()=>M(),style:{backgroundColor:"#3b82f6",color:"white",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer"},children:"+ 필드 추가"})]}),(0,o.jsx)("div",{style:{backgroundColor:"#f0fdf4",padding:"0.75rem",borderRadius:"0.375rem",marginBottom:"1rem",fontSize:"0.8rem",color:"#166534"},children:"\uD83D\uDCA1 필드는 스캔 페이지에서 목적 선택 시 표시됩니다. 필드명(영문)은 웹훅 전송 시 키로 사용되며, purpose_data.필드명 또는 필드명으로 매핑할 수 있습니다."}),0===u.length?(0,o.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:"등록된 필드가 없습니다."}):(0,o.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{borderBottom:"2px solid #e5e7eb"},children:[(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left"},children:"필드명"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left"},children:"라벨"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left"},children:"타입"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"center"},children:"필수"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"left"},children:"기본값"}),(0,o.jsx)("th",{style:{padding:"0.75rem",textAlign:"center"},children:"작업"})]})}),(0,o.jsx)("tbody",{children:u.map(e=>{var t;return(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,o.jsx)("td",{style:{padding:"0.75rem",fontFamily:"monospace"},children:e.field_name}),(0,o.jsx)("td",{style:{padding:"0.75rem"},children:e.field_label}),(0,o.jsx)("td",{style:{padding:"0.75rem"},children:null===(t=d.find(t=>t.value===e.field_type))||void 0===t?void 0:t.label}),(0,o.jsx)("td",{style:{padding:"0.75rem",textAlign:"center"},children:e.is_required?"✓":""}),(0,o.jsx)("td",{style:{padding:"0.75rem"},children:e.default_value||"-"}),(0,o.jsxs)("td",{style:{padding:"0.75rem",textAlign:"center"},children:[(0,o.jsx)("button",{onClick:()=>M(e),style:{color:"#3b82f6",background:"none",border:"none",cursor:"pointer",marginRight:"0.5rem"},children:"수정"}),(0,o.jsx)("button",{onClick:()=>K(e.id),style:{color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:"삭제"})]})]},e.id)})})]})]}),"webhooks"===S&&(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600"},children:"연결된 웹훅"}),(0,o.jsx)("button",{onClick:()=>B(!0),style:{backgroundColor:"#3b82f6",color:"white",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer"},children:"+ 웹훅 연결"})]}),(0,o.jsx)("div",{style:{backgroundColor:"#fdf4ff",padding:"0.75rem",borderRadius:"0.375rem",marginBottom:"1rem",fontSize:"0.8rem",color:"#7e22ce"},children:"\uD83D\uDCA1 여기에 연결된 웹훅은 이 목적의 태그 이벤트 발생 시 자동 호출됩니다. 웹훅은 설정 페이지에서 먼저 등록해야 합니다."}),0===m.length?(0,o.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:"연결된 웹훅이 없습니다."}):(0,o.jsx)("div",{style:{display:"grid",gap:"1rem"},children:m.map(e=>(0,o.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"0.375rem",padding:"1rem"},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{fontWeight:"600"},children:el(e.webhook_id)}),e.field_mappings&&(0,o.jsx)("pre",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.5rem",backgroundColor:"#f3f4f6",padding:"0.5rem",borderRadius:"0.25rem"},children:JSON.stringify(e.field_mappings,null,2)})]}),(0,o.jsx)("button",{onClick:()=>ee(e.id),style:{color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:"삭제"})]})},e.id))})]}),"rules"===S&&(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600"},children:"태그 규칙"}),(0,o.jsx)("button",{onClick:()=>Z(!0),style:{backgroundColor:"#3b82f6",color:"white",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer"},children:"+ 규칙 추가"})]}),(0,o.jsx)("div",{style:{backgroundColor:"#fefce8",padding:"0.75rem",borderRadius:"0.375rem",marginBottom:"1rem",fontSize:"0.8rem",color:"#854d0e"},children:"\uD83D\uDCA1 규칙으로 태그 이벤트 처리 방식을 설정합니다. 중복 정책(window_minutes)으로 짧은 시간 내 중복 태그를 억제할 수 있습니다."}),0===b.length?(0,o.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:"등록된 규칙이 없습니다."}):(0,o.jsx)("div",{style:{display:"grid",gap:"1rem"},children:b.map(e=>{var t;return(0,o.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"0.375rem",padding:"1rem"},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{fontWeight:"600"},children:null===(t=s.find(t=>t.value===e.rule_type))||void 0===t?void 0:t.label}),(0,o.jsx)("pre",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.5rem",backgroundColor:"#f3f4f6",padding:"0.5rem",borderRadius:"0.25rem"},children:JSON.stringify(e.rule_config,null,2)})]}),(0,o.jsx)("button",{onClick:()=>er(e.id),style:{color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:"삭제"})]})},e.id)})})]}),"followups"===S&&(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600"},children:"후속 처리"}),(0,o.jsx)("button",{onClick:()=>P(!0),style:{backgroundColor:"#3b82f6",color:"white",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer"},children:"+ 후속 처리 추가"})]}),(0,o.jsx)("div",{style:{backgroundColor:"#fef2f2",padding:"0.75rem",borderRadius:"0.375rem",marginBottom:"1rem",fontSize:"0.8rem",color:"#991b1b"},children:"\uD83D\uDCA1 후속 처리는 태그 이벤트 등록 후 추가 작업을 수행합니다. 알림, 승인 요청, 외부 API 호출 등을 설정할 수 있습니다."}),0===f.length?(0,o.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#6b7280"},children:"등록된 후속 처리가 없습니다."}):(0,o.jsx)("div",{style:{display:"grid",gap:"1rem"},children:f.map(e=>{var t;return(0,o.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"0.375rem",padding:"1rem"},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{fontWeight:"600"},children:null===(t=c.find(t=>t.value===e.action_type))||void 0===t?void 0:t.label}),(0,o.jsx)("pre",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.5rem",backgroundColor:"#f3f4f6",padding:"0.5rem",borderRadius:"0.25rem"},children:JSON.stringify(e.action_config,null,2)})]}),(0,o.jsx)("button",{onClick:()=>ei(e.id),style:{color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:"삭제"})]})},e.id)})})]}),R&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"2rem",width:"100%",maxWidth:"500px"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1.5rem"},children:D?"필드 수정":"필드 추가"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"필드명 (영문) *"}),(0,o.jsx)("input",{type:"text",value:N.field_name,onChange:e=>O({...N,field_name:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},placeholder:"예: lecture_id"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"라벨 (표시명) *"}),(0,o.jsx)("input",{type:"text",value:N.field_label,onChange:e=>O({...N,field_label:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},placeholder:"예: 강의 ID"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"타입 *"}),(0,o.jsx)("select",{value:N.field_type,onChange:e=>O({...N,field_type:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},children:d.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"checkbox",id:"is_required",checked:N.is_required,onChange:e=>O({...N,is_required:e.target.checked})}),(0,o.jsx)("label",{htmlFor:"is_required",children:"필수 필드"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"기본값"}),(0,o.jsx)("input",{type:"text",value:N.default_value,onChange:e=>O({...N,default_value:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"}})]}),"select"===N.field_type&&(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"옵션 (쉼표 구분)"}),(0,o.jsx)("input",{type:"text",value:N.options,onChange:e=>O({...N,options:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},placeholder:"옵션1, 옵션2, 옵션3"})]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[(0,o.jsx)("button",{onClick:Y,style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"1px solid #d1d5db",backgroundColor:"white",cursor:"pointer"},children:"취소"}),(0,o.jsx)("button",{onClick:V,style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",backgroundColor:"#3b82f6",color:"white",cursor:"pointer"},children:D?"저장":"추가"})]})]})}),W&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"2rem",width:"100%",maxWidth:"500px"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1.5rem"},children:"웹훅 연결"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"웹훅 선택 *"}),(0,o.jsxs)("select",{value:L.webhook_id,onChange:e=>Q({...L,webhook_id:Number(e.target.value)}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},children:[(0,o.jsx)("option",{value:0,children:"웹훅을 선택하세요"}),w.map(e=>(0,o.jsxs)("option",{value:e.id,children:[e.name," (",e.target_url,")"]},e.id))]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"필드 매핑 (JSON)"}),(0,o.jsx)("textarea",{value:L.field_mappings,onChange:e=>Q({...L,field_mappings:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",minHeight:"100px",fontFamily:"monospace"},placeholder:'{"lecture_id": "lectureId"}'})]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[(0,o.jsx)("button",{onClick:()=>B(!1),style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"1px solid #d1d5db",backgroundColor:"white",cursor:"pointer"},children:"취소"}),(0,o.jsx)("button",{onClick:$,style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",backgroundColor:"#3b82f6",color:"white",cursor:"pointer"},children:"연결"})]})]})}),z&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"2rem",width:"100%",maxWidth:"500px"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1.5rem"},children:"규칙 추가"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"규칙 유형 *"}),(0,o.jsx)("select",{value:E.rule_type,onChange:e=>q({...E,rule_type:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},children:s.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"규칙 설정 (JSON) *"}),(0,o.jsx)("textarea",{value:E.rule_config,onChange:e=>q({...E,rule_config:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",minHeight:"100px",fontFamily:"monospace"}})]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[(0,o.jsx)("button",{onClick:()=>Z(!1),style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"1px solid #d1d5db",backgroundColor:"white",cursor:"pointer"},children:"취소"}),(0,o.jsx)("button",{onClick:et,style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",backgroundColor:"#3b82f6",color:"white",cursor:"pointer"},children:"추가"})]})]})}),F&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"0.5rem",padding:"2rem",width:"100%",maxWidth:"500px"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1.5rem"},children:"후속 처리 추가"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"액션 유형 *"}),(0,o.jsx)("select",{value:U.action_type,onChange:e=>J({...U,action_type:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem"},children:c.map(e=>(0,o.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"액션 설정 (JSON) *"}),(0,o.jsx)("textarea",{value:U.action_config,onChange:e=>J({...U,action_config:e.target.value}),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",minHeight:"100px",fontFamily:"monospace"}})]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[(0,o.jsx)("button",{onClick:()=>P(!1),style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"1px solid #d1d5db",backgroundColor:"white",cursor:"pointer"},children:"취소"}),(0,o.jsx)("button",{onClick:eo,style:{padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",backgroundColor:"#3b82f6",color:"white",cursor:"pointer"},children:"추가"})]})]})})]}):(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,o.jsx)("div",{children:"잘못된 접근입니다."})})}},4734:function(e,t,r){"use strict";r.d(t,{Q:function(){return a}});var o=r(1892);let i=r(9792).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",l=()=>{let e=localStorage.getItem("access_token");return{Authorization:"Bearer ".concat(e)}},a={getAllPurposes:async()=>(await o.Z.get("".concat(i,"/purposes"),{headers:l()})).data,getActivePurposes:async()=>(await o.Z.get("".concat(i,"/purposes/active"),{headers:l()})).data,getPurposeById:async e=>(await o.Z.get("".concat(i,"/purposes/").concat(e),{headers:l()})).data,createPurpose:async e=>(await o.Z.post("".concat(i,"/purposes"),e,{headers:l()})).data,updatePurpose:async(e,t)=>(await o.Z.put("".concat(i,"/purposes/").concat(e),t,{headers:l()})).data,async deletePurpose(e){await o.Z.delete("".concat(i,"/purposes/").concat(e),{headers:l()})},getFields:async e=>(await o.Z.get("".concat(i,"/purposes/").concat(e,"/fields"),{headers:l()})).data,createField:async(e,t)=>(await o.Z.post("".concat(i,"/purposes/").concat(e,"/fields"),t,{headers:l()})).data,updateField:async(e,t)=>(await o.Z.put("".concat(i,"/purposes/fields/").concat(e),t,{headers:l()})).data,async deleteField(e){await o.Z.delete("".concat(i,"/purposes/fields/").concat(e),{headers:l()})},getWebhooks:async e=>(await o.Z.get("".concat(i,"/purposes/").concat(e,"/webhooks"),{headers:l()})).data,createWebhook:async(e,t)=>(await o.Z.post("".concat(i,"/purposes/").concat(e,"/webhooks"),t,{headers:l()})).data,updateWebhook:async(e,t)=>(await o.Z.put("".concat(i,"/purposes/webhooks/").concat(e),t,{headers:l()})).data,async deleteWebhook(e){await o.Z.delete("".concat(i,"/purposes/webhooks/").concat(e),{headers:l()})},getRules:async e=>(await o.Z.get("".concat(i,"/purposes/").concat(e,"/rules"),{headers:l()})).data,createRule:async(e,t)=>(await o.Z.post("".concat(i,"/purposes/").concat(e,"/rules"),t,{headers:l()})).data,updateRule:async(e,t)=>(await o.Z.put("".concat(i,"/purposes/rules/").concat(e),t,{headers:l()})).data,async deleteRule(e){await o.Z.delete("".concat(i,"/purposes/rules/").concat(e),{headers:l()})},getFollowups:async e=>(await o.Z.get("".concat(i,"/purposes/").concat(e,"/followups"),{headers:l()})).data,createFollowup:async(e,t)=>(await o.Z.post("".concat(i,"/purposes/").concat(e,"/followups"),t,{headers:l()})).data,updateFollowup:async(e,t)=>(await o.Z.put("".concat(i,"/purposes/followups/").concat(e),t,{headers:l()})).data,async deleteFollowup(e){await o.Z.delete("".concat(i,"/purposes/followups/").concat(e),{headers:l()})},getAllStats:async()=>(await o.Z.get("".concat(i,"/purposes/stats"),{headers:l()})).data,getPurposeStats:async e=>(await o.Z.get("".concat(i,"/purposes/").concat(e,"/stats"),{headers:l()})).data,async getLogs(e){let t=new URLSearchParams;return(null==e?void 0:e.purposeId)&&t.append("purposeId",e.purposeId.toString()),(null==e?void 0:e.entityType)&&t.append("entityType",e.entityType),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(await o.Z.get("".concat(i,"/purposes/logs?").concat(t.toString()),{headers:l()})).data},validateData:async(e,t)=>(await o.Z.post("".concat(i,"/purposes/").concat(e,"/validate"),t,{headers:l()})).data}},5463:function(e,t,r){"use strict";r.d(t,{L:function(){return l}});var o=r(1892);let i=r(9792).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",l={async getAllWebhooks(){let e=localStorage.getItem("access_token");return(await o.Z.get("".concat(i,"/webhooks"),{headers:{Authorization:"Bearer ".concat(e)}})).data},async createWebhook(e){let t=localStorage.getItem("access_token");return(await o.Z.post("".concat(i,"/webhooks"),e,{headers:{Authorization:"Bearer ".concat(t)}})).data},async updateWebhook(e,t){let r=localStorage.getItem("access_token");return(await o.Z.put("".concat(i,"/webhooks/").concat(e),t,{headers:{Authorization:"Bearer ".concat(r)}})).data},async deleteWebhook(e){let t=localStorage.getItem("access_token");await o.Z.delete("".concat(i,"/webhooks/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},async testWebhook(e){let t=localStorage.getItem("access_token");return(await o.Z.post("".concat(i,"/webhooks/").concat(e,"/test"),{},{headers:{Authorization:"Bearer ".concat(t)}})).data},async getMappings(e){let t=localStorage.getItem("access_token");return(await o.Z.get("".concat(i,"/webhook-mappings/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}})).data},async createMapping(e,t,r){let l=localStorage.getItem("access_token");return(await o.Z.post("".concat(i,"/webhook-mappings"),{webhook_id:e,from_key:t,to_key:r},{headers:{Authorization:"Bearer ".concat(l)}})).data},async updateMapping(e,t,r){let l=localStorage.getItem("access_token");return(await o.Z.put("".concat(i,"/webhook-mappings/").concat(e),{from_key:t,to_key:r},{headers:{Authorization:"Bearer ".concat(l)}})).data},async deleteMapping(e){let t=localStorage.getItem("access_token");await o.Z.delete("".concat(i,"/webhook-mappings/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}})}}},6179:function(e,t,r){e.exports=r(319)}},function(e){e.O(0,[885,115,141,744],function(){return e(e.s=9313)}),_N_E=e.O()}]);