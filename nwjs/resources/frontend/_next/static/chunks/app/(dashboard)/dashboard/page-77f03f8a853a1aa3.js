(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{3404:function(e,t,r){Promise.resolve().then(r.bind(r,4648))},4648:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var o=r(7821),i=r(8078),n=r(1981),l=r(2076);function s(){var e,t,r,s,a,d,c;let{user:u}=(0,n.a)(),[h,f]=(0,i.useState)(null),[g,m]=(0,i.useState)(null),[v,x]=(0,i.useState)([]),[p,y]=(0,i.useState)(0),[b,S]=(0,i.useState)(!0);(0,i.useEffect)(()=>{j()},[]);let j=async()=>{try{try{let e=await l.Z.get("/reports/events");f(e.data)}catch(e){console.error("Failed to fetch event stats:",e)}try{let e=await l.Z.get("/reports/webhooks");m(e.data)}catch(e){console.error("Failed to fetch webhook stats:",e)}try{let e=await l.Z.get("/events",{params:{limit:5}});x(e.data.data||[])}catch(e){console.error("Failed to fetch recent events:",e)}try{let e=new Date().toISOString().split("T")[0],t=await l.Z.get("/reports/events",{params:{startDate:e}});y(t.data.total||0)}catch(e){console.error("Failed to fetch today count:",e)}}catch(e){console.error("Failed to fetch dashboard data:",e)}finally{S(!1)}},w=e=>{try{return new Date(e).toLocaleString("ko-KR",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e}},k=()=>g&&g.total_calls?Math.round(g.successful_calls/g.total_calls*100):0,_=()=>{var e;return(null==h?void 0:null===(e=h.eventsByDay)||void 0===e?void 0:e.length)?Math.max(...h.eventsByDay.map(e=>e.count),1):1};return b?(0,o.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:(0,o.jsx)("div",{style:{fontSize:"1.125rem",color:"#6b7280"},children:"Loading dashboard..."})}):(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",marginBottom:"2rem",color:"#1f2937"},children:"Dashboard"}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1.5rem",borderRadius:"1rem",color:"white",boxShadow:"0 4px 6px -1px rgba(102, 126, 234, 0.3)"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",opacity:.9,marginBottom:"0.5rem"},children:"총 이벤트"}),(0,o.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:(null==h?void 0:null===(e=h.total)||void 0===e?void 0:e.toLocaleString())||0}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.7,marginTop:"0.5rem"},children:"전체 태그 스캔 횟수"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",padding:"1.5rem",borderRadius:"1rem",color:"white",boxShadow:"0 4px 6px -1px rgba(245, 87, 108, 0.3)"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",opacity:.9,marginBottom:"0.5rem"},children:"오늘 이벤트"}),(0,o.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:p.toLocaleString()}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.7,marginTop:"0.5rem"},children:"오늘 발생한 태그"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",padding:"1.5rem",borderRadius:"1rem",color:"white",boxShadow:"0 4px 6px -1px rgba(79, 172, 254, 0.3)"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",opacity:.9,marginBottom:"0.5rem"},children:"고유 카드"}),(0,o.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:(null==h?void 0:null===(t=h.unique_cards)||void 0===t?void 0:t.toLocaleString())||0}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.7,marginTop:"0.5rem"},children:"등록된 카드 수"})]}),(0,o.jsxs)("div",{style:{background:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",padding:"1.5rem",borderRadius:"1rem",color:"white",boxShadow:"0 4px 6px -1px rgba(67, 233, 123, 0.3)"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",opacity:.9,marginBottom:"0.5rem"},children:"활성 웹훅"}),(0,o.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:[(null==g?void 0:g.activeWebhooks)||0," / ",(null==g?void 0:g.totalWebhooks)||0]}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",opacity:.7,marginTop:"0.5rem"},children:"웹훅 연동 상태"})]})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[(0,o.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem",color:"#374151"},children:"\uD83D\uDCCA 최근 7일 이벤트 트렌드"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"flex-end",gap:"0.5rem",height:"160px"},children:[null==h?void 0:null===(r=h.eventsByDay)||void 0===r?void 0:r.slice(0,7).reverse().map((e,t)=>{var r;let i=Math.max(e.count/_()*100,5);return(0,o.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.25rem"},children:e.count}),(0,o.jsx)("div",{style:{width:"100%",height:"".concat(i,"px"),background:"linear-gradient(180deg, #667eea 0%, #764ba2 100%)",borderRadius:"0.375rem 0.375rem 0 0",transition:"height 0.3s ease"}}),(0,o.jsx)("div",{style:{fontSize:"0.625rem",color:"#9ca3af",marginTop:"0.5rem"},children:null===(r=e.date)||void 0===r?void 0:r.slice(5)})]},t)}),(!(null==h?void 0:h.eventsByDay)||0===h.eventsByDay.length)&&(0,o.jsx)("div",{style:{flex:1,textAlign:"center",color:"#9ca3af",paddingTop:"60px"},children:"데이터가 없습니다"})]})]}),(0,o.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem",color:"#374151"},children:"\uD83D\uDD17 웹훅 성공률 (최근 30일)"}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"2rem"},children:[(0,o.jsxs)("div",{style:{position:"relative",width:"120px",height:"120px"},children:[(0,o.jsxs)("svg",{viewBox:"0 0 36 36",style:{width:"100%",height:"100%",transform:"rotate(-90deg)"},children:[(0,o.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e5e7eb",strokeWidth:"3"}),(0,o.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:k()>=90?"#10b981":k()>=70?"#f59e0b":"#ef4444",strokeWidth:"3",strokeDasharray:"".concat(k(),", 100")})]}),(0,o.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:(0,o.jsxs)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1f2937"},children:[k(),"%"]})})]}),(0,o.jsxs)("div",{style:{flex:1},children:[(0,o.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,o.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"총 호출"}),(0,o.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1f2937"},children:(null==g?void 0:null===(s=g.total_calls)||void 0===s?void 0:s.toLocaleString())||0})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"1.5rem"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#10b981"},children:"✓ 성공"}),(0,o.jsx)("div",{style:{fontWeight:"600",color:"#10b981"},children:(null==g?void 0:null===(a=g.successful_calls)||void 0===a?void 0:a.toLocaleString())||0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#ef4444"},children:"✗ 실패"}),(0,o.jsx)("div",{style:{fontWeight:"600",color:"#ef4444"},children:(null==g?void 0:null===(d=g.failed_calls)||void 0===d?void 0:d.toLocaleString())||0})]})]})]})]})]})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[(0,o.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem",color:"#374151"},children:"\uD83C\uDFC6 TOP 5 카드"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[null==h?void 0:null===(c=h.topCards)||void 0===c?void 0:c.slice(0,5).map((e,t)=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[(0,o.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",backgroundColor:0===t?"#fbbf24":1===t?"#9ca3af":2===t?"#d97706":"#e5e7eb",color:t<3?"white":"#6b7280"},children:t+1}),(0,o.jsx)("div",{style:{flex:1,fontFamily:"monospace",fontSize:"0.875rem",color:"#374151"},children:e.card_uid}),(0,o.jsxs)("div",{style:{fontWeight:"600",color:"#667eea"},children:[e.count,"회"]})]},e.card_uid)),(!(null==h?void 0:h.topCards)||0===h.topCards.length)&&(0,o.jsx)("div",{style:{textAlign:"center",color:"#9ca3af",padding:"2rem"},children:"데이터가 없습니다"})]})]}),(0,o.jsxs)("div",{style:{backgroundColor:"white",padding:"1.5rem",borderRadius:"1rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("h2",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem",color:"#374151"},children:"\uD83D\uDD50 최근 이벤트"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[v.map(e=>(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[(0,o.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#10b981"}}),(0,o.jsx)("div",{style:{flex:1,fontFamily:"monospace",fontSize:"0.875rem",color:"#374151"},children:e.card_uid}),(0,o.jsx)("div",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:w(e.event_time)})]},e.id)),0===v.length&&(0,o.jsx)("div",{style:{textAlign:"center",color:"#9ca3af",padding:"2rem"},children:"최근 이벤트가 없습니다"})]})]})]})]})}},1981:function(e,t,r){"use strict";r.d(t,{a:function(){return l}});var o=r(8433),i=r(2076);let n={login:async e=>(await i.Z.post("/auth/login",e)).data,refreshToken:async e=>(await i.Z.post("/auth/refresh",{refresh_token:e})).data,getCurrentUser:async()=>(await i.Z.get("/auth/me")).data,logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}},l=(0,o.Ue)((e,t)=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isLoading:!0,setTokens:(t,r)=>{localStorage.setItem("access_token",t),localStorage.setItem("refresh_token",r),e({accessToken:t,refreshToken:r,isAuthenticated:!0})},setUser:t=>{e({user:t,isAuthenticated:!!t})},setLoading:t=>{e({isLoading:t})},login:async(r,o)=>{try{e({isLoading:!0});let i=await n.login({username:r,password:o});t().setTokens(i.access_token,i.refresh_token),e({user:i.user,isAuthenticated:!0})}catch(e){throw console.error("Login failed:",e),e}finally{e({isLoading:!1})}},logout:()=>{n.logout(),e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1})},refreshUser:async()=>{try{e({isLoading:!0});let t=await n.getCurrentUser();e({user:t,isAuthenticated:!0})}catch(e){console.error("Failed to refresh user:",e),t().logout()}finally{e({isLoading:!1})}}}));{let e=localStorage.getItem("access_token"),t=localStorage.getItem("refresh_token");e&&t?(l.setState({accessToken:e,refreshToken:t,isAuthenticated:!0,isLoading:!0}),l.getState().refreshUser()):l.setState({isLoading:!1})}},2076:function(e,t,r){"use strict";var o=r(1892);let i=r(9792).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",n=o.Z.create({baseURL:i,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t,r,l;let s=e.config,a=(null===(t=s.url)||void 0===t?void 0:t.includes("/auth/login"))||(null===(r=s.url)||void 0===r?void 0:r.includes("/auth/refresh")),d=localStorage.getItem("refresh_token");if((null===(l=e.response)||void 0===l?void 0:l.status)===401&&!s._retry&&!a&&d){s._retry=!0;try{let{access_token:e,refresh_token:t}=(await o.Z.post("".concat(i,"/auth/refresh"),{refresh_token:d})).data;return localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",t),s.headers&&(s.headers.Authorization="Bearer ".concat(e)),n(s)}catch(e){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)}),t.Z=n},8940:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o=r(8078),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=o.useState,l=o.useEffect,s=o.useLayoutEffect,a=o.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!i(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),o=n({inst:{value:r,getSnapshot:t}}),i=o[0].inst,c=o[1];return s(function(){i.value=r,i.getSnapshot=t,d(i)&&c({inst:i})},[e,r,t]),l(function(){return d(i)&&c({inst:i}),e(function(){d(i)&&c({inst:i})})},[e]),a(r),r};t.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:c},6259:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o=r(8078),i=r(4268),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},l=i.useSyncExternalStore,s=o.useRef,a=o.useEffect,d=o.useMemo,c=o.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,o,i){var u=s(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var f=l(e,(u=d(function(){function e(e){if(!a){if(a=!0,l=e,e=o(e),void 0!==i&&h.hasValue){var t=h.value;if(i(t,e))return s=t}return s=e}if(t=s,n(l,e))return t;var r=o(e);return void 0!==i&&i(t,r)?(l=e,t):(l=e,s=r)}var l,s,a=!1,d=void 0===r?null:r;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,r,o,i]))[0],u[1]);return a(function(){h.hasValue=!0,h.value=f},[f]),c(f),f}},4268:function(e,t,r){"use strict";e.exports=r(8940)},8780:function(e,t,r){"use strict";e.exports=r(6259)},8433:function(e,t,r){"use strict";r.d(t,{Ue:function(){return h}});let o=e=>{let t;let r=new Set,o=(e,o)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=o?o:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,n={setState:o,getState:i,getInitialState:()=>l,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},l=t=e(o,i,n);return n},i=e=>e?o(e):o;var n=r(8078),l=r(8780);let{useDebugValue:s}=n,{useSyncExternalStoreWithSelector:a}=l,d=!1,c=e=>e,u=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?i(e):e,r=(e,r)=>(function(e,t=c,r){r&&!d&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),d=!0);let o=a(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return s(o),o})(t,e,r);return Object.assign(r,t),r},h=e=>e?u(e):u}},function(e){e.O(0,[885,115,141,744],function(){return e(e.s=3404)}),_N_E=e.O()}]);